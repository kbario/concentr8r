<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Streamlined 1D NMR Preprocessing — preproc • concentr8r</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Streamlined 1D NMR Preprocessing — preproc" />
<meta property="og:description" content="preproc() is a function aimed at streamlining the preprocessing stage of analysing NMR spectra. It harnesses the power of all preprocessing functions with in concentr8r to quickly and easily process spectra." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">concentr8r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Preprocessing.html">Preprocessing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Streamlined 1D NMR Preprocessing</h1>
    
    <div class="hidden name"><code>preproc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>preproc()</code> is a function aimed at streamlining the preprocessing stage of analysing NMR spectra. It harnesses the power of all preprocessing functions with in concentr8r to quickly and easily process spectra.</p>
    </div>

    <pre class="usage"><span class='fu'>preproc</span><span class='op'>(</span>
  <span class='va'>X</span>,
  <span class='va'>ppm</span>,
  <span class='va'>meta</span>,
  bline <span class='op'>=</span> <span class='cn'>TRUE</span>,
  flip <span class='op'>=</span> <span class='cn'>TRUE</span>,
  cali <span class='op'>=</span> <span class='cn'>TRUE</span>,
  calib <span class='op'>=</span> <span class='st'>"tsp"</span>,
  linw <span class='op'>=</span> <span class='fl'>1</span>,
  lowCut <span class='op'>=</span> <span class='fl'>0.25</span>,
  watCut <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4.5</span>, <span class='fl'>5</span><span class='op'>)</span>,
  ureCut <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5.6</span>, <span class='fl'>6</span><span class='op'>)</span>,
  uppCut <span class='op'>=</span> <span class='fl'>9.5</span>,
  noi_sh <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>9.5</span>, <span class='fl'>11</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>A matrix containing the non-preprocessed NMR spectral data. The rows should containing all values of a single experiment, and the columns, the values of the chemical shift variables.</p></td>
    </tr>
    <tr>
      <th>ppm</th>
      <td><p>An array of the chemical shift variables, column matched to X.</p></td>
    </tr>
    <tr>
      <th>meta</th>
      <td><p>The matrix of metadata pertaining to the X matrix. This is crucial for the TSP calibration and line width calculation.</p></td>
    </tr>
    <tr>
      <th>bline</th>
      <td><p>Default is set to <code>TRUE</code>. This argument calls on <code><a href='bl.html'>bl()</a></code>, a baseline correcting function to smooth the spectral baselines and remove the influence of broad peaks.</p></td>
    </tr>
    <tr>
      <th>flip</th>
      <td><p>Default is set to <code>TRUE</code>. <strong>NOT CRUCIAL FOR STANDARDLY ACQUIRED SPECTRA</strong> This function checks the orientation of spectra. This is a particularly important function for spectra derived from a <strong>small number of scans</strong>; the NMR orientates spectra based on what side of the y-axis has the most signal and water has a very large impact on this and without a large amount of metabolite signal on the correct side of the spectra (as seen in spectra derived from small scans) the spectra will be orientated the wrong way.</p></td>
    </tr>
    <tr>
      <th>cali</th>
      <td><p>Default is set to <code>TRUE</code>. This calls on the <code><a href='cali.html'>cali()</a></code> function of concentr8r which ensures peaks are aligned based on the TSP signal. Calibration is standardly performed by the NMR but this can be performed again for certainty.</p></td>
    </tr>
    <tr>
      <th>calib</th>
      <td><p>This is the signal you wish to use as the calibrant. For urine spectra, <em>tsp</em> is the main calibrant.</p></td>
    </tr>
    <tr>
      <th>linw</th>
      <td><p>This argument defines the maximum line width that the tsp should have which is spectral validation. It uses the lw() function to calculate the line width of peaks. Spectra with peaks that have small line widths have sharper and more precise results which is more desirable. A maximum cutoff of 1 ensures spectra contain robust results. Consider omitting spectra with line widths over 1.</p></td>
    </tr>
    <tr>
      <th>lowCut</th>
      <td><p>A single floating point number defining the ppm value that the lower limit of the spectra are trimmed to.</p></td>
    </tr>
    <tr>
      <th>watCut</th>
      <td><p>The lower and upper ppm values concatenated, from which the water region will be trimmed and omitted. Water regions provide no important information and should be removed prior to data analysis. Default is set to <code><a href='https://rdrr.io/r/base/c.html'>c(4.5,5)</a></code></p></td>
    </tr>
    <tr>
      <th>ureCut</th>
      <td><p>The lower and upper ppm values concatenated, from which the urea region will be trimmed and omitted. Urea regions also provide no important information and should be removed prior to data analysis. Default is set to <code><a href='https://rdrr.io/r/base/c.html'>c(5.6,6)</a></code></p></td>
    </tr>
    <tr>
      <th>uppCut</th>
      <td><p>A single floating point number defining the ppm value that the upper limit of the spectra are trimmed to.</p></td>
    </tr>
    <tr>
      <th>noi_sh</th>
      <td><p>The shift of the noise region used to calculate estimation of noise</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>This function returns a list with:</p><ol>
<li><p>The processed X matrix in the first element,</p></li>
<li><p>The processed ppm array in the second element, and</p></li>
<li><p>The line width results in a data frame in the third element.</p></li>
</ol>
<ul>
<li><p>Following the example below will extract the results quickly and easily.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>preproc()</code> carries out a range of functions. Below is a simplistic run through. See the vignette "Preprocessing" to learn more about the process.</p>
    <h2 class="hasAnchor" id="the-pipeline"><a class="anchor" href="#the-pipeline"></a>The Pipeline</h2>

    <p>This function streamlines the preprocessing of NMR urine spectra by combining a range of functions. It:</p><ol>
<li><p>Orientates the spectra correctly,</p></li>
<li><p>Calibrates the spectra by a specific peak,</p></li>
<li><p>Calculates the line widths of the peaks and returns a warning with the spectra that exceed the specified threshold,</p></li>
<li><p>Removes the lower, upper, water and urea regions of the spectra,</p></li>
<li><p>Corrects the baseline of the spectra using asymmetric least squares</p></li>
<li><p>Verifies that the resulting X, ppm and meta objects match appropriately.</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other preproc: 
<code><a href='bl.html'>bl</a>()</code>,
<code><a href='cali.html'>cali</a>()</code>,
<code><a href='read_in.html'>read_in</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p><a href='mailto:kylebario1@gmail.com'>kylebario1@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='read_in.html'>read_in</a></span><span class='op'>(</span>path<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>'extdata'</span>,package<span class='op'>=</span><span class='st'>'concentr8r'</span><span class='op'>)</span>,
        exp_type<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>exp<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PROF_URINE_NOESY"</span><span class='op'>)</span><span class='op'>)</span>,
        n_spec <span class='op'>=</span> <span class='st'>'multiple'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ppm</span>, <span class='va'>X</span><span class='op'>[</span><span class='fl'>2</span>,<span class='op'>]</span>, type <span class='op'>=</span> <span class='st'>'l'</span>, col <span class='op'>=</span> <span class='st'>'red'</span>,
    main <span class='op'>=</span> <span class='st'>'NMR Spectra (Processed vs. Non Processed)'</span>,
    xlab <span class='op'>=</span> <span class='st'>'Chemical Shift (ppm)'</span>, ylab <span class='op'>=</span> <span class='st'>'Intensity'</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>preproc</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>ppm</span>, <span class='va'>meta</span>, flip <span class='op'>=</span> <span class='cn'>TRUE</span>, cali <span class='op'>=</span> <span class='cn'>TRUE</span>, calib <span class='op'>=</span> <span class='st'>'tsp'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #0000BB;'>Flipping the spectra... </span><span style='color: #00BB00; font-weight: bold;'>Done.
#&gt; </span><span style='color: #0000BB;'>Calibrating to tsp... </span><span style='color: #00BB00; font-weight: bold;'>Done.
#&gt; </span><span style='color: #0000BB;'>Checking line width of spectra... </span><span style='color: #00BB00; font-weight: bold;'>All spectra have linewidths under 1 
#&gt; </span><span style='color: #0000BB;'>Removing non-quantative regions... </span><span style='color: #00BB00; font-weight: bold;'>Done.
#&gt; </span><span style='color: #0000BB;'>Performing baseline correction... </span><span style='color: #00BB00; font-weight: bold;'>Done.
#&gt; </span><span style='color: #0000BB;'>Calculating Noise Estimations... </span><span style='color: #00BB00; font-weight: bold;'>Done.
#&gt; </span><span style='color: #0000BB;'>Checking that X and meta rows match... </span><span style='color: #00BB00; font-weight: bold;'>Done.
#&gt; </span><span style='color: #0000BB;'>Checking that ppm length and X columns match... </span><span style='color: #00BB00; font-weight: bold;'>Done.
#&gt; </span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>ppm</span>, <span class='va'>X</span><span class='op'>[</span><span class='fl'>2</span>,<span class='op'>]</span>, type <span class='op'>=</span> <span class='st'>'l'</span>, col <span class='op'>=</span> <span class='st'>'blue'</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>'topleft'</span>, legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Unprocessed"</span>, <span class='st'>"Processed"</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'red'</span>, <span class='st'>'blue'</span><span class='op'>)</span>, lty <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='img'><img src='preproc-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kyle Bario, Torben Kimhofer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


